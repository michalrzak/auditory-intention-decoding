@startuml

class Audio {
    +NDArray[float] array
    +int sampling_frequency
}

package auditory_tagging {
    abstract class AAudioTagger {
      #list[ [float, float] ] stimuli_intervals

      +AAuditoryTagger(audio, stimuli)
      +Audio {abstract} create()
    }

    AAudioTagger "1" *-u- "1" Audio: audio


    abstract class AAudioTaggerFactory {
      +AAudioTagger {abstract} create_audio_tagger(audio: Audio, stimuli_intervals: List[Tuple[float, float])
    }

    package assr_tagger {
        class AMTagger {
          -int frequency
          -Callable[[int, int, int], NDArray[float] tag_generator
          -[float, float] signal_interval

          +ASSRTagger(audio, stimuli_intervals, frequency, tag_generator, signal_interval)
          +Audio create()
        }

        class FMTagger {
          -int frequency
          -float modulation_factor

          +FMTagger(audio, stimuli_intervals, frequency, modulation_factor)
          +Audio create()
          -(NDArray[Real], NDArray[Real]) {static} extract_amplitudes_phases(numbers: NDArray[Complex])
          -NDArray[Complex] {static} get_complex_number(amplitudes: NDArray[Real], phases: NDArray[Real])
          -NDArray[Real] phases_to_instantaneous_frequencies(phases: NDArray[Real])
          -NDArray[Real] instantaneous_frequencies_to_phases(instantaneous_frequencies: NDArray[Real], first_phase: Real)
          -NDArray[float32] modulate(signal: NDArray[float32])

        }

        class FlippedFMTagger {
          -int frequency

          +FlippedFMTagger(audio, stimuli_intervals, frequency)
          +Audio create()

        }

        class AMTaggerFactory {
          -int frequency
          -Callable[[int, int, int], NDArray[float]] tag_generator
          -(float, float) signal_interval

          +AMTaggerFactory(frequency, tag_generator, signal_interval)
        }

        class FlippedFMTaggerFactory {
          -int frequency

          +FlippedFMTaggerFactory(frequency)
        }

        class FMTaggerFactory {
          -int frequency

          +FMTaggerFactory(frequency)
        }
    }

    class NoiseTaggingTagger {
      -Optional[int] seed
      -int bit_width
      -int length_bit
      +Optional[Code] code

      +NoiseTaggingTagger(audio, stimuli_intervals, bits_per_second: int, length_bit, seed)
      +Audio create()
      -void __generate_code()
      -void __get_code(length: int)
    }

    class NoiseTaggingTaggerFactory {
      -int bits_per_second
      -int length_bit
      -Optional[int] seed

      +NoiseTaggingTaggerFactory(bits_per_second, length_bit, seed)
    }

    class RawTagger {
      +Audio create()
    }

    class RawTaggerFactory {
    }

    class ShiftSumTagger {
      -int shift_by

      +ShiftSumTagger(audio, stimuli_intervals, shift_by)
      +Audio create()
    }

    class ShiftSumTaggerFactory {
      -int shift_by
      +ShiftSumTaggerFactory(shift_by)
    }
}

AAudioTagger <|-- ShiftSumTagger
AAudioTagger <|-- RawTagger
AAudioTagger <|-- NoiseTaggingTagger
AAudioTagger <|-- AMTagger
AAudioTagger <|-- FMTagger
AAudioTagger <|-- FlippedFMTagger

AAudioTaggerFactory <|-u- ShiftSumTaggerFactory
AAudioTaggerFactory <|-u- AMTaggerFactory
AAudioTaggerFactory <|-u- FMTaggerFactory
AAudioTaggerFactory <|-u- FlippedFMTaggerFactory
AAudioTaggerFactory <|-u- NoiseTaggingTaggerFactory
AAudioTaggerFactory <|-u- RawTaggerFactory

ShiftSumTagger <.. ShiftSumTaggerFactory: "creates"
AMTagger <.. AMTaggerFactory: "creates"
FMTagger <.. FMTaggerFactory: "creates"
FlippedFMTagger <.. FlippedFMTaggerFactory: "creates"
NoiseTaggingTagger <.. NoiseTaggingTaggerFactory: "creates"
RawTagger <.. RawTaggerFactory: "creates"


@enduml